{% extends 'pages/employee_dashboard.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% load user_tags %}
{% block title %}Basic Information List{% endblock %}

{% block dashboard_employee %}
<!-- Code -->
<div class="my-4 py-4" >
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mx-3 mb-3">
        <h4 class="mx-3 mb-0 text-gray-800">Profile Buiding Lookup </h4>
        <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i
                class="fas fa-download fa-sm text-white-50 px-3"></i> Generate Report</a>
    </div>
   <!-- progress bar -->
    <div class="container mt-5">
        <div class="progress my-3 mx-auto" style="height: 20px; width:95%;">
            <div class="shadow text-white progress-bar {% if progress_percentage < 25 %}bg-danger{% elif progress_percentage < 50 %}bg-warning{% elif progress_percentage < 75 %}bg-info{% else %}bg-success{% endif %}" role="progressbar" style="width: {{ progress_percentage }}%;" aria-valuenow="{{ progress_percentage }}" aria-valuemin="0" aria-valuemax="100">
              <span class="py-5 fs-6">{{ progress_percentage }} %</span>
            </div>
        </div>  
        <div class="album py-3 bg-light">
            {% if progress %}
            <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4">
                {% for progres in progress %}
                <!--Accept Policies-->
                <div class="col step-item ">
                    <div class="card border-left-danger shadow h-100 py-2">
                        <div class="card-body">
                    
                        <h6 class="card-text ">
                            <i class="fas fa-shield fa-1x text-gray-300" aria-hidden="true"></i>
                            Policies 
                        </h6>
                        <small class="">Step 1: Accept Policies</small>
                        <div class="d-flex justify-content-between align-items-center">
                            {% if  progres.companyPolices_completed %}
                                <div class="btn-group gap-1">
                                    <button type="button" class="prev-btn  btn btn-sm btn-success">
                                        <i class="bi bi-check2-circle text-light px-1"></i><small>Completed</small>
                                    </button>
                                    <a href="{% url 'employee:policies_list' %}" type="button" class="prev-btn  btn btn-sm btn-outline-secondary"><i class="bi bi-box-arrow-left"></i></a>
                                </div>
                            {% else %}                       
                                <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#policiesModal">
                                    Accept 
                                </button>
                            {% endif %}
                            
                        </div>
                        
                        </div>
                    </div>
                </div>
                <!--Basic Information-->
                {% if  progres.companyPolices_completed %}
                <div class="col step-item ">
                <div class="card border-left-warning shadow h-100 py-2">
                    <div class="card-body">
                    <h6 class="card-text ">
                        <i class="bi bi-info-circle"></i>
                        Basic Information
                    </h6>
                    <small class="">Step 2: Basic Information</small>
                    <div class="d-flex justify-content-between align-items-center">
                        
                            {% if progres.basic_information_completed %}
                                <div class="btn-group gap-1">
                                    <button type="button" class="prev-btn  btn btn-sm btn-success">
                                        <i class="bi bi-check2-circle text-light px-1"></i>
                                        <small>Completed</small>
                                    </button>
                                    <a href="{% url 'employee:basic_information_list' %}" type="button" class="prev-btn  btn btn-sm btn-outline-secondary"><i class="bi bi-pen"></i></a>
                                   
                                </div>
                            {% else %} 
                                <!-- Basic Information Step -->
                                <button type="button" class="btn btn-sm btn-outline-secondary" id="basicInformationModalButton" data-bs-toggle="modal" data-bs-target="#basicInformationModal">
                                    Create
                                </button>
                            {% endif %}
                        
                    </div>
                    </div>
                </div>
                </div>
                {% endif %}
                <!--Personal-->
                {% if progres.basic_information_completed %}
                <div class="col step-item ">
                    <div class="card border-left-success shadow h-100 py-2">
                        <div class="card-body">
                            
                        <h6 class="card-text text-decoration-bold">
                            <i class="bi bi-person-circle px-1"></i>
                            Personal
                        </h6>
                        <small class="">Step 3: Personal Information</small>
                        <div class="d-flex justify-content-between align-items-center">
                            {% if progres.personal_information_completed %}
                                <div class="btn-group gap-1">
                                    <button type="button" class="prev-btn  btn btn-sm btn-success shadow">
                                        <i class="bi bi-check2-circle px-1"></i><small>Completed!</small>
                                    </button>
                                    <a href="{% url 'employee:personal_list' %}" type="button" class="prev-btn  btn btn-sm btn-outline-secondary"><i class="bi bi-pen"></i></a>
                                    
                                    <!-- Modal Trigger Button -->
                                
                                </div>
                            {% else %}
                                <!-- Personal Step -->
                                <button type="button" class="btn btn btn-sm btn-outline-secondary" id="personalModalButton" data-bs-toggle="modal" data-bs-target="#personalModal">
                                    Create
                                </button> 
                            {% endif %}
                        </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                <!--Military-->
                {% if progres.personal_information_completed %} 
                <div class="col step-item ">
                    <div class="card border-left-primary shadow h-100 py-2">
                        <div class="card-body">
                        <h6 class="card-text">
                            <i class="bi bi-airplane-fill px-1"></i>
                            Military
                        </h6>
                        <small class="">Step 4: Military </small>
                        <div class="d-flex justify-content-between align-items-center">
                            {% if progres.Military_completed  %}
                            <div class="btn-group gap-1">
                                <button type="button" class="prev-btn  btn btn-sm btn-success shadow">
                                    <i class="bi bi-check2-circle px-1"></i><small>Completed!</small>
                                </button>
                               <a href="{% url 'employee:military_list' %}" type="button" class="prev-btn  btn btn-sm btn-outline-secondary"><i class="bi bi-pen"></i></a>
                            </div>
                            {% else %}
                            <div class="btn-group gap-1">
                                <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#militaryModal">
                                    Create
                                </button>
                                <form action="{% url 'employee:skip_military' %}" method="post">
                                    {% csrf_token %}
                                    <button type="submit" class="next-btn btn btn-sm btn-outline-secondary">Skip</button>
                                </form>
                            </div>
                            {% endif %}
                        </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                <!--Education-->
                {% if progres.Military_completed  %}
                <div class="col step-item ">
                 <div class="card border-left-primary shadow h-100 pt-1">
                    <div class="card-body">
                    <h6 class="card-text"><i class="fa-solid fa-user-graduate"></i> Education</h6>
                    <small class="">Step 5: Education & upload files</small>
                    <div class="d-flex justify-content-between align-items-center">
                        {% if progres.Education_completed  %}
                        <div class="btn-group gap-1">
                          <button type="button" class="prev-btn  btn btn-sm btn-success shadow">
                            <i class="bi bi-check2-circle px-1"></i><small>Completed!</small>
                          </button>
                          <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#CertificationLicenseModal">
                            <i class="fa-regular fa-square-plus"></i> <i class="fa-solid fa-upload"></i>
                         </button>
                          <a class="btn btn-sm btn-outline-secondary" href="{% url 'employee:education_list' %}"><i class="bi bi-pen"></i></a>
                        </div>
                        {% else %}
                         <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#educationModal">
                            Create
                         </button>
                        {% endif %}

                    </div>
                    {% if certification_licenses %}
                    <ul class="list-unstyled list-group-flush">
                    {% for certification in certification_licenses|slice:":2" %}
                        <li class="list-item"><small class=""><a href="{{ certification.certification_file.url}}"><i class="bi bi-files px-1"></i>{{ certification.document_name|truncatewords:2 }}</a></small></li>
                    {% endfor %}
                    </ul>
                    {% endif %}
                   
                    </div>
                 </div>
                </div>
                {% endif %}
                <!--Experience-->
                {% if progres.Education_completed   %}
                <div class="col step-item ">
                <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                    <h6 class="card-text"><i class="fa-sharp fa-solid fa-trophy"></i>  Experience</h6>
                    <small class="">Step 6: Experience </small>
                    <div class="d-flex justify-content-between align-items-center">
                        {% if progres.Experience_completed %}
                        <div class="btn-group gap-1">
                            <button type="button" class="prev-btn  btn btn-sm btn-success shadow">
                                <i class="bi bi-check2-circle px-1"></i><small>Completed!</small>
                            </button>
                           <a href="{% url 'employee:experience_list' %}" type="button" class="prev-btn  btn btn-sm btn-outline-secondary"><i class="bi bi-pen"></i></a>
                        </div>
                        {% else %}
                        <div class="btn-group gap-1">
                            <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#experienceFormModal">
                                Create
                            </button>
                            <form action="{% url 'employee:no_Experience' %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="next-btn btn btn-sm btn-outline-secondary">No experience</button>
                            </form>
                        </div>
                        {% endif %}
                    </div>
                    </div>
                </div>
                </div>
                {% endif %}
                <!--Preferences-->
                {% if progres.Experience_completed %}
                <div class="col step-item ">
                <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                    <h6 class="card-text"><i class="fa-solid fa-asterisk px-1"></i>Preferences</h6>
                    <small class="">Step 7: Preferences </small>
                    <div class="d-flex justify-content-between align-items-center">
                        
                        {% if progres.Preferences_completed %}
                        <div class="btn-group gap-1">
                            <button type="button" class="prev-btn  btn btn-sm btn-success shadow">
                                <i class="bi bi-check2-circle px-1"></i><small>Completed!</small>
                            </button>
                            <a href="#" type="button" class="prev-btn  btn btn-sm btn-outline-secondary"><i class="bi bi-pen"></i></a>
                            
                            <!-- Modal Trigger Button -->
                        
                        </div>
                        {% else %}
                            <!-- Personal Step -->
                            <div class="btn-group">
                                <button type="button"  class="btn btn btn-sm btn-outline-secondary mt-3" data-bs-toggle="modal" data-bs-target="#preferencesModal">
                                    Create
                                </button>
                            </div>
                         
                        {% endif %}
                    </div>
                    </div>
                </div>
                </div>
                {% endif %}
                {% if progres.Preferences_completed %}
                <div class="col step-item ">
                <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                    <p class="card-text">Preferences</p>
                    <div class="d-flex justify-content-between align-items-center">
                        {% if progres.SkillSetTest_completed %}
                        <div class="btn-group">
                        <button type="button" class="prev-btn  btn btn-sm btn-outline-secondary">Previous</button>
                        <button type="button" class="btn btn-sm btn-outline-secondary">Save</button>
                        <button type="button" class="next-btn btn btn-sm btn-outline-secondary">Next</button>
                        </div>
                        {% endif %}
                    </div>
                    </div>
                </div>
                </div>
                {% endif %}
                {% if progres.SkillSetTest_completed %}
                <div class="col step-item ">
                <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                    <p class="card-text">Skillset Test</p>
                    <div class="d-flex justify-content-between align-items-center">
                        {% if progres.VideoResume_completed %}
                        <div class="btn-group">
                        <button type="button" class="prev-btn  btn btn-sm btn-outline-secondary">Previous</button>
                        <button type="button" class="btn btn-sm btn-outline-secondary">Save</button>
                        <button type="button" class="next-btn btn btn-sm btn-outline-secondary">Next</button>
                        </div>
                        {% endif %}
                    </div>
                    </div>
                </div>
                </div>
                {% endif %}
                {% if progres.VideoResume_completed %}
                <div class="col step-item ">
                    <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                        <p class="card-text">Skillset Test</p>
                        <div class="d-flex justify-content-between align-items-center">
                        {% if progres.ResumeUploading_completed %}
                        <div class="btn-group">
                            <button type="button" class="prev-btn  btn btn-sm btn-outline-secondary">Previous</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary">Save</button>
                            <button type="button" class="next-btn btn btn-sm btn-outline-secondary">Next</button>
                        </div>
                        {% endif %}
                        </div>
                    </div>
                    </div>
                </div>
                {% endif %}
                {% if progres.ResumeUploading_completed %}
                <div class="col step-item ">
                    <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                        <p class="card-text">Video resume</p>
                        <div class="d-flex justify-content-between align-items-center">
                        {% if progres.ResumeUploading_completed %}
                        <div class="btn-group">
                            <button type="button" class="prev-btn  btn btn-sm btn-outline-secondary">Previous</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary">Save</button>
                            <button type="button" class="next-btn btn btn-sm btn-outline-secondary">Next</button>
                        </div>
                        {% endif %}
                        </div>
                    </div>
                    </div>
                </div>
                {% endif %}
                {% if progres.ResumeUploading_completed %}
                <div class="col step-item ">
                    <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                        <p class="card-text">Resume uploading</p>
                        <div class="d-flex justify-content-between align-items-center">
                        <div class="btn-group">
                            <button type="button" class="prev-btn  btn btn-sm btn-outline-secondary">Previous</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary">Save</button>
                            <button type="button" class="next-btn btn btn-sm btn-outline-secondary">Next</button>
                        </div>
                        </div>
                    </div>
                    </div>
                </div>
                {% endif %}
                {% if progres.ResumeUploading_completed %}
                <div class="col step-item ">
                    <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                        <p class="card-text">Background Check</p>
                        <div class="d-flex justify-content-between align-items-center">
                        <div class="btn-group">
                            <button type="button" class="prev-btn  btn btn-sm btn-outline-secondary">Previous</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary">Save</button>
                            <button type="button" class="next-btn btn btn-sm btn-outline-secondary">Next</button>
                        </div>
                        </div>
                    </div>
                    </div>
                </div>
                {% endif %}
                {% if progres.ResumeUploading_completed %}
                <div class="col step-item ">
                    <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                        <p class="card-text">Resume uploading</p>
                        <div class="d-flex justify-content-between align-items-center">
                        <div class="btn-group">
                            <button type="button" class="prev-btn  btn btn-sm btn-outline-secondary">Previous</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary">Save</button>
                            <button type="button" class="next-btn btn btn-sm btn-outline-secondary">Next</button>
                        </div>
                        </div>
                    </div>
                    </div>
                </div>
                {% endif %}
                {% if progres.ResumeUploading_completed %}
                <div class="col step-item ">
                    <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                        <p class="card-text">Resume uploading</p>
                        <div class="d-flex justify-content-between align-items-center">
                        <div class="btn-group">
                            <button type="button" class="prev-btn  btn btn-sm btn-outline-secondary">Previous</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary">Save</button>
                            <button type="button" class="next-btn btn btn-sm btn-outline-secondary">Next</button>
                        </div>
                        </div>
                    </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            {% else %}
            <div class="row row-cols-1 row-cols-sm-8 row-cols-md-10">
                <div class="card mb-4 bg-warning">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">you must stere built your profile</h6>
                    </div>
                    <div class="card-body">
                        <p class="mb-0"> oops its semes like you need start built you profile !!
                            by accepting the policys </p>
                    </div>
                </div>
            </div>
            {% endif %}
            </div>
        </div>
    </div>
    
    <!-- modele -->
    <div class="container">
        <!-- Profile Building Progress content -->
        <!-- profileBuildingProgress.html -->

            <!-- Policies Modal -->
            <div class="modal fade" id="policiesModal" tabindex="-1" aria-labelledby="policiesModalLabel" aria-hidden="true">
                <div class="modal-dialog  modal-lg modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                    <h5 class="modal-title" id="policiesModalLabel">Accept Policies</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="card shadow mb-4">
                            <!-- Card Header - Dropdown -->
                            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                {% if all_policies_accepted %}
                                 <h6 class="m-0 font-weight-bold text-success">To Review all policies Click Read </h6>
                                {% else %}
                                 <h6 class="m-0 font-weight-bold text-primary">Read and accepted for next steps</h6>
                                {% endif %}
                                <div class="dropdown no-arrow">
                                    {% if all_policies_accepted %}               
                                        <a class="btn btn-sm btn-outline-success text-decoration-none" data-bs-toggle="collapse" 
                                            href="#multiCollapseExample2" role="button" aria-expanded="true" aria-controls="multiCollapseExample2">
                                            <i class="bi bi-arrows-fullscreen text-white-600 px-2"></i> Read
                                        </a>
                                    {% else %}
                                        <a class="btn btn-sm btn-outline-primary text-decoration-none" data-bs-toggle="collapse" 
                                            href="#multiCollapseExample1" role="button" aria-expanded="true" aria-controls="multiCollapseExample1">
                                            <i class="bi bi-arrows-fullscreen text-white-600"></i> Start
                                        </a>
                                    {% endif %}
                                </div>
                            </div>
                            <!-- Card Body -->
                            <div class="card-body">
                                <div class="">
                                    <div class="row">
                                        <div class="col-12">
                                            <div class="multi-collapse collapsing show" id="multiCollapseExample1" style="">
                                                {% if all_policies_accepted %}
                                                <p>All policies have been accepted.</p>
                                                {% else %}
                                                <form id="policy-form"  method="POST"  class="needs-validation was-validated" novalidate="">
                                                    {% csrf_token %}
                                                    <div class="card card-body">
                                                        <div class="accordion accordion-flush" id="accordionFlushExample">
                                                        
                                                                {% for policy in policies %}
                                                                    <div class="accordion-item ">
                                                                        <h2 class="accordion-header" id="flush-heading{{policy.id}}">
                                                                            <button class="accordion-button collapsed text-s" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse{{policy.id}}" aria-expanded="false" aria-controls="flush-collapse{{policy.id}}">
                                                                                {{ policy.title }} *
                                                                            </button>
                                                                        </h2>
                                                                        <div id="flush-collapse{{policy.id}}" class="accordion-collapse collapse" aria-labelledby="flush-heading{{policy.id}}" data-bs-parent="#accordionFlushExample">
                                                                            <div class="accordion-body " style="overflow: auto; height: 300px;">
                                                                                <div>
                                                                                    <h5 class="card-title">Special title treatment</h5>
                                                                                    <p class="card-text">
                                                                                        {{ policy.description }}
                                                                                    </p>
                                                                                    {% if user.is_authenticated %}
                                                                                        {% if policy.id not in accepted_policies_ids %}
                                                                                        <!--<input type="radio" name="policy_{{ policy.id }}">-->
                                                                                        <div class="col-12">
                                                                                            <div class="form-check">
                                                                                              <input class="form-check-input" name="policy_{{ policy.id }}" type="checkbox" id="invalidCheck{{ policy.id }}" required="">
                                                                                              <label class="form-check-label" for="invalidCheck">
                                                                                                Agree to terms and conditions
                                                                                              </label>
                                                                                              <div class="invalid-feedback">
                                                                                                You must agree before submitting.
                                                                                              </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        {% endif %}
                                                                                            
                                                                                    {% endif %}
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                {% endfor %}
                                                            
                                                        </div>
                                                    </div>
                                                    <div class="card-footer">
                                                        <div class="row row-cols-lg-auto g-1 align-items-center border-0 ">
                                                            <div class="col-8 text-start px-1 py-1 border-0">
                                                                <div class="form-check ">
                                                                    <input class="form-check-input" type="checkbox" id="inlineFormCheckMane">
                                                                    <label class="form-check-label" for="inlineFormCheckMane">
                                                                    I Read and Accept all.
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        
                                                            <div class="col-4 text-end  px-1 py-1 border-none">
                                                                <button name="policies" class=" btn btn-sm btn-outline-primary" type="submit">I Accept</button>
                                                            </div>
                                                    </div>
                                                    
                                                </form>
                                                {% endif %}
                                                {% if all_policies_accepted %}
                                                <script>
                                                document.getElementById("policy-form").style.display = "none";
                                                </script>
                                                {% endif %}
                                            </div>
                                        </div>
                                        
                                        <div class="col-12">
                                            <div class="multi-collapse collapsing show" id="multiCollapseExample2" style="">
                                                <div class="card card-body">
                                                    <div class="accordion accordion-flush" id="accordionFlushExample">
                                                        {% if all_policies_accepted %}
                                                            <p>All policies have been accepted.</p>
                                                            {% for policy in policies %}
                                                                <div class="accordion-item ">
                                                                    <h2 class="accordion-header" id="flush-heading{{policy.id}}">
                                                                        <button class="accordion-button collapsed text-s" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse{{policy.id}}" aria-expanded="false" aria-controls="flush-collapse{{policy.id}}">
                                                                            {{ policy.title }}
                                                                        </button>
                                                                    </h2>
                                                                    <div id="flush-collapse{{policy.id}}" class="accordion-collapse collapse" aria-labelledby="flush-heading{{policy.id}}" data-bs-parent="#accordionFlushExample">
                                                                        <div class="accordion-body " style="overflow: auto; height: 300px;">
                                                                            <div>
                                                                                <h5 class="card-title">Special title treatment</h5>
                                                                                <p class="card-text">
                                                                                    {{ policy.description }}
                                                                                </p>
                                                                                
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            {% endfor %}
                                                        
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% if all_policies_accepted %}
                                <div class="py-3 d-flex flex-row align-items-center justify-content-between">
                                    <p>All policies have been accepted successfuly, You Can read it whenever you want it, just click read button.</p>
                                    <a class="btn btn-sm btn-outline-success text-decoration-none" href="{% url 'employee:profile_building_progress' %}" role="button" >
                                        Back
                                    </a>
                                </div>
                                {% endif %}
                            </div>
                           
                        </div>
                    </div>
                </div>
                </div>
            </div>
            <!-- Basic Information Modal -->
            <div class="modal fade" id="basicInformationModal" tabindex="-1" aria-labelledby="basicInformationModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-scrollable">
                    <div class="modal-content mx-4">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="exampleModalLabel">Basic Information</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <!--Modal content for Basic Information -->
                            <form method="POST">
                                {% csrf_token %}
                                {{ basic_information_form|crispy }}
                                <div class="modal-footer">
                                    <button type="submit" name="basic_information" class="btn btn-sm btn-outline-primary">Save</button>
                                    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="modal">Back</button>
                                </div>
                            </form>
                        
                        </div>
                    </div>
                </div>
            </div>
            <!-- Personal Modal -->
            <div class="modal fade" id="personalModal" tabindex="-1" aria-labelledby="personalModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-scrollable">
                    <div class="modal-content">
                    <!-- Modal content for Personal -->
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">Personal Information</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <!--Modal content for Basic Information -->
                        <form method="POST">
                            {% csrf_token %}
                            {{ personal_form|crispy }}
                            <div class="modal-footer">
                                <button type="submit"  name="personal"  class="btn btn-sm btn-outline-primary">Save</button>
                                <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="modal">Back</button>
                            </div>
                        </form>
                    
                    </div>
                    </div>
                </div>
            </div>
            <!--Modal Step 4: Military Information -->
            <div class="modal fade" id="militaryModal" tabindex="-1" aria-labelledby="militaryModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-sm modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="militaryModalLabel">Military Information</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form method="POST" enctype="multipart/form-data">   
                                {% csrf_token %}
                                {{ military_form|crispy }}
                                <div class="modal-footer">
                                    <button type="submit" name="military" class="btn btn-sm btn-outline-success">Save</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Education Modal -->
            <div class="modal fade" id="educationModal" tabindex="-1" aria-labelledby="educationModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="educationModalLabel">Education</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form method="POST" action="{% url 'employee:profile_building_progress' %}">
                                {% csrf_token %}
                                {{ education_form|crispy}}
                                <!-- Include other fields of the EducationForm -->
                                <button type="submit" name="education" class="btn btn-primary">Save</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
             <!-- Education Modal -->
             <div class="modal fade" id="CertificationLicenseModal" tabindex="-1" aria-labelledby="CertificationLicenseModalModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-sm">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="CertificationLicenseModalModalLabel">Education</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form method="POST" enctype="multipart/form-data" action="{% url 'employee:profile_building_progress' %}">
                                {% csrf_token %}
                                {{ CertificationLicense_form|crispy}}
                                <!-- Include other fields of the EducationForm -->
                                <button type="submit" name="certificationLicense" class="btn btn-sm btn-outline-success">Save</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
             <!--Modal Step 6: experience Form Modal-->
             <div class="modal fade" id="experienceFormModal" tabindex="-1" aria-labelledby="experienceFormModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-md modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="experienceFormModalLabel">Experience Information</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form method="POST" enctype="multipart/form-data">   
                                {% csrf_token %}
                                {{ experienceForm_form|crispy }}
                                <div class="modal-footer">
                                    <button type="submit" name="experience" class="btn btn-sm btn-outline-success">Save</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Bootstrap Modal Button -->

            <!-- Bootstrap Modal -->
            <div class="modal fade" id="preferencesModal" tabindex="-1" aria-labelledby="preferencesModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-md modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h6 class="modal-title" id="preferencesModalLabel">Employee Preferences</h6>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <!-- Employee Preferences Section -->
                            <form method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                {{ employee_preferences_form|crispy }}
                                <button name="preferences" value="save" type="submit" class="btn btn-primary">Save</button>
                            </form><!--
                            <form method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-2 g-3">
                                    <div class="col" id="div_id_minimum_salary">
                                        <label for="id_minimum_salary" class="form-label requiredField">Minimum salary<span class="asteriskField">*</span></label>
                                        <input type="number" name="minimum_salary" min="1.00" step="0.01" class="numberinput form-control form-control-sm" required="" id="id_minimum_salary">
                                    </div>
                                    <div class="col" id="div_id_salary_type">
                                        <label for="id_salary_type" class="form-label requiredField">Salary type<span class="asteriskField">*</span></label>
                                        <select name="salary_type" class="select form-select form-select-sm" required="" id="id_salary_type" aria-label="salary type">
                                            <option value="" selected="">---------</option>
                                            <option value="annual">Annual Salary</option>
                                            <option value="monthly">Monthly Salary</option>
                                            <option value="twoWeeks">Two Weeks Salary</option>
                                            <option value="weekly">Weekly Salary</option>
                                            <option value="daily">Daily Rate</option>
                                            <option value="hourly">Hourly Wage</option>
                                            <option value="commission">Commission</option>
                                            <option value="bonus">Bonus</option>
                                            <option value="profit_sharing">Profit Sharing</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                    <div class="col" id="div_id_location">
                                        <label for="id_location" class="form-label requiredField">Location<span class="asteriskField">*</span></label>
                                        <input type="text" name="location" maxlength="100" class="textinput form-control form-control-sm" required="" id="id_location">
                                    </div>
                                    <div class="col" id="div_id_can_relocation">
                                        <label for="id_can_relocation" class="form-label requiredField">Relocation?<span class="asteriskField">*</span></label>
                                        <select name="can_relocation" class="select form-select form-select-sm" required="" id="id_can_relocation">
                                            <option value="" selected="">---</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                    </div>
                                    <div class="col" id="div_id_job_type">
                                        <label for="id_job_type" class="form-label requiredField">Job type<span class="asteriskField">*</span></label>
                                        <select name="job_type" class="select form-select form-select-sm" required="" id="id_job_type">
                                            <option value="" selected="">---------</option>
                                            <option value="full-time">Full-time</option>
                                            <option value="part-time">Part-time</option>
                                            <option value="contract">Contract/Freelance</option>
                                            <option value="internship">Internship</option>
                                            <option value="apprenticeship">Apprenticeship</option>
                                            <option value="remote">Remote/Telecommute</option>
                                            <option value="shift-based">Shift-based</option>
                                            <option value="volunteer">Volunteer</option>
                                            <option value="consultant">Consultant</option>
                                            <option value="permanent">Permanent</option>
                                            <option value="temporary">Temporary</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                    <div class="col" id="div_id_years_of_experience">
                                        <label for="id_years_of_experience" class="form-label requiredField">Years of experience<span class="asteriskField">*</span></label>
                                        <input type="number" name="years_of_experience" step="0.01" class="numberinput form-control form-control-sm" required="" id="id_years_of_experience">
                                    </div>
                                    <div class="col" id="div_id_category">
                                        <label for="id_category" class="form-label requiredField">Category<span class="asteriskField">*</span></label>
                                        <select name="category" class="form-control form-select-sm select form-select" id="id_category" required="">
                                            <option value="" selected="">---------</option>
                                            <option value="1">accounting &amp; finance</option>
                                        </select>
                                    </div>
                                    <div class="col" id="div_id_desired_positions">
                                        <label for="id_desired_positions" class="form-label requiredField">Desired positions<span class="asteriskField">*</span></label>
                                        <select name="desired_positions" class="form-control select form-select-sm form-select" id="id_desired_positions" required="">
                                            <option value="" selected="">---------</option>
                                        </select>
                                    </div>
                                    <div class="col" id="div_id_skills">
                                        <div id="div_id_custom_positions">
                                            <label for="id_skills" class="form-label requiredField">Skills<span class="asteriskField">*</span></label>
                                            <select name="skills" size="2" aria-label="size 3" class="form-control selectmultiple form-select form-select-sm" id="id_skills" required="" multiple=""></select>
                                        </div>
                                    </div>
                                    <div class="col d-flex gap-2">
                                        <div id="div_id_custom_positions">
                                            <label for="id_custom_positions" class="form-label">Positions</label>
                                            <input type="text" name="custom_positions" maxlength="200" class="textinput form-control form-control-sm" id="id_custom_positions">
                                        </div>
                                        <div id="div_id_custom_skills" class="mb-3">
                                            <label for="id_custom_skills" class="form-label">Skills</label>
                                            <textarea name="custom_skills" cols="40" rows="1" class="textarea form-control form-control-sm" id="id_custom_skills"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <button name="preferences" value="save" type="submit" class="btn btn-sm btn-outline-primary my-3">Save</button>
                            </form>-->
                            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                            <script>
                                $(document).ready(function() {
                                // Update positions dropdown based on selected category
                                $('#id_category').on('change', function() {
                                    var categoryId = $(this).val();
                                    $.ajax({
                                    url: "{% url 'employee:positions' %}",
                                    data: { category_id: categoryId },
                                    success: function(response) {
                                        var positions = response.positions;
                                        var positionSelect = $('#id_desired_positions');
                                        positionSelect.empty();
                                        
                                        // Add default option for positions dropdown
                                        positionSelect.append('<option value="" selected="">---------</option>');
                                        
                                        $.each(positions, function(index, position) {
                                        positionSelect.append('<option value="' + position.id + '">' + position.position + '</option>');
                                        });
                                    }
                                    });
                                });
                            
                                // Update skills dropdown based on selected position
                                $('#id_desired_positions').on('change', function() {
                                    var positionId = $(this).val();
                                    $.ajax({
                                    url: "{% url 'employee:skills' %}",
                                    data: { position_id: positionId },
                                    success: function(response) {
                                        var skills = response.skills;
                                        var skillsSelect = $('#id_skills');
                                        skillsSelect.empty();
                                        
                                        $.each(skills, function(index, skill) {
                                        skillsSelect.append('<option value="' + skill.id + '">' + skill.skill + '</option>');
                                        });
                                    }
                                    });
                                });
                                });
                            </script>
                        </div> 
                    </div>
                </div>
            </div>

    </div>     

</div>  
{% block scripts %}
    <script>
        $(document).ready(function() {
        // Open Basic Information Modal
        $('#basicInformationModalButton').click(function() {
            $('#basicInformationModal').modal('show');
        });

        // Open Personal Modal
        $('#personalModalButton').click(function() {
            $('#personalModal').modal('show');
        });
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const progress = document.querySelector(".progress-bar1");
            const steps = Array.from(document.querySelectorAll(".step-item"));
            const stepCount = steps.length;
            let currentStep = 1;
        
            function updateProgressBar() {
                const percent = (currentStep - 1) / (stepCount - 1) * 100;
                progress.style.width = percent + "%";
                progress.setAttribute("aria-valuenow", percent);
            }
        
            function setActiveStep() {
                steps.forEach((step, index) => {
                if (index === currentStep - 1) {
                    step.classList.add("active");
                } else {
                    step.classList.remove("active");
                }
                });
            }
    
            function goToNextStep() {
                if (currentStep < stepCount) {
                currentStep++;
                updateProgressBar();
                setActiveStep();
                }
            }
        
            function goToPreviousStep() {
                if (currentStep > 1) {
                currentStep--;
                updateProgressBar();
                setActiveStep();
                }
            }
        
            // Event listeners for next and previous buttons
            const nextBtns = document.getElementsByClassName("next-btn");
            const prevBtns = document.getElementsByClassName("prev-btn");
        
            for (let i = 0; i < nextBtns.length; i++) {
                nextBtns[i].addEventListener("click", goToNextStep);
            }
    
        for (let i = 0; i < prevBtns.length; i++) {
            prevBtns[i].addEventListener("click", goToPreviousStep);
        }
    
        updateProgressBar();
        setActiveStep();
        });
    </script> 
{% endblock %} 
{% endblock %}
